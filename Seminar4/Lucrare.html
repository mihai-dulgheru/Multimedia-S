<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript">
        let date = [
            { "tara": "BG", "an": 2013, "pop": 11137974 },
            { "tara": "BG", "an": 2014, "pop": 11180840 },
            { "tara": "BG", "an": 2015, "pop": 11237274 },
            { "tara": "BG", "an": 2016, "pop": 11311117 },
            { "tara": "BG", "an": 2017, "pop": 11351727 },
            { "tara": "BG", "an": 2018, "pop": 11398589 },
            { "tara": "HU", "an": 2013, "pop": 2971905 },
            { "tara": "HU", "an": 2014, "pop": 2943472 },
            { "tara": "HU", "an": 2015, "pop": 2921262 },
            { "tara": "HU", "an": 2016, "pop": 2888558 },
            { "tara": "HU", "an": 2017, "pop": 2847904 },
            { "tara": "HU", "an": 2018, "pop": 2808901 },
            { "tara": "RO", "an": 2013, "pop": 10487289 },
            { "tara": "RO", "an": 2014, "pop": 10427301 },
            { "tara": "RO", "an": 2015, "pop": 10374822 },
            { "tara": "RO", "an": 2016, "pop": 10341330 },
            { "tara": "RO", "an": 2017, "pop": 10309573 },
            { "tara": "RO", "an": 2018, "pop": 10291027 }
        ];

        //2) Scrieți codul JavaScript care face ca la apăsarea butonului Adaugă să se adauge în vector și în tabel datele
        //preluate de la utilizator.
        function afisare() {
            let tbody = document.querySelector('tbody');
            tbody.innerHTML = '';

            for (let element of date) {
                let rand = document.createElement('tr');
                tbody.appendChild(rand);

                for (let numeCamp in element) {
                    let celula = document.createElement('td');
                    celula.innerText = element[numeCamp];
                    rand.append(celula);

                    //    celula.addEventListener('click', e => {
                    //        e.target.style.backgroundColor = 'yellow';
                    //    });
                }
            }
        }

        function aplicatie() {
            afisare();

            document.querySelector('#btnAdauga').addEventListener('click', e => {
                let element = {
                    tara: document.querySelector('#tara').value,
                    an: parseInt(document.querySelector('#an').value, 10),
                    pop: parseInt(document.querySelector('#pop').value, 10)
                };
                date.push(element);
                afisare();
            });

            //3) Scrieți codul JavaScript care face ca la apăsarea butonului Sumar să se afișeze la consolă on vector de obiecte
            //de forma { an: 2013, total: 278643; }, unde total reprezintă populația totală pentru anul respectiv.
            document.querySelector('#btnSumar').addEventListener('click', e => {
                //    let ani = [];
                //    for (let elem of date) {
                //        if (ani.indexOf(elem.an) < 0) {
                //            ani.push(elem.an);
                //        }
                //    }
                //    let vector = [];
                //    for (let an of ani) {
                //        let total = 0;
                //        for (let elem of date) {
                //            if (an === elem.an) {
                //                total += elem.pop;
                //            }
                //        }
                //        vector.push({ an: an, total: total });
                //    }
                //    console.log(vector);

                let rezultat = {};
                for (let elem of date) {
                    if (rezultat[elem.an]) {
                        rezultat[elem.an] += elem.pop;
                    } else {
                        rezultat[elem.an] = elem.pop;
                    }
                }
                let vector = [];
                for (let an in rezultat) {
                    vector.push({ an: an, total: rezultat[an] });
                }
                console.log(vector);
            });

            //4) Scrieți codul JavaScript care la click pe o celulă din tabel schimbă culoarea fundalului acesteia în galben.
            document.querySelector('table').addEventListener('click', e => {
                //console.log(e.target.innerText);
                //e.target.style.backgroundColor = 'yellow';
                //e.target.classList.add('onClick');
                if (e.target.tagName === 'TD') {
                    e.target.classList.add('onClick');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', aplicatie);
    </script>

    <style type="text/css">
        .onClick {
            background-color: aquamarine;
        }
    </style>

</head>
<body>
    <!--1) Adăugați în documentul HTML:
    * un tabel gol cu trei coloane (tara, an, populație)
    * un element de tip select care să conțină lista de țări
    * un element de tip select care să conțină o listă de ani (2019 - 2021)
    * un element de tip text
    * un buton Adauga
    * un buton Sumar-->
    <table>
        <thead>
            <tr>
                <th>Tara</th>
                <th>An</th>
                <th>Populatie</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <select id="tara">
        <option value="BG">BG</option>
        <option value="HU">HU</option>
        <option value="RO">RO</option>
    </select>

    <select id="an">
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
    </select>

    <input id="pop" />
    <input type="button" id="btnAdauga" value="Adauga" />
    <input type="button" id="btnSumar" value="Sumar" />

</body>
</html>